<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üé∞ Royal Casino</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary: #8b5cf6;
      --primary-dark: #7c3aed;
      --secondary: #06b6d4;
      --accent: #f59e0b;
      --success: #10b981;
      --danger: #ef4444;
      --bg-dark: #0f0f1a;
      --bg-card: #1a1a2e;
      --bg-card-light: #252542;
      --text-primary: #ffffff;
      --text-secondary: #a1a1aa;
      --gold: #fbbf24;
      --gold-dark: #d97706;
    }

    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      background: linear-gradient(180deg, var(--bg-dark) 0%, #1a0a2e 50%, #0a1628 100%);
      min-height: 100vh;
      color: var(--text-primary);
      overflow-x: hidden;
    }

    /* Animated background */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 20% 20%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(6, 182, 212, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 50% 50%, rgba(245, 158, 11, 0.05) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }

    .container {
      max-width: 500px;
      margin: 0 auto;
      padding: 16px;
      position: relative;
      z-index: 1;
    }

    .card {
      background: linear-gradient(145deg, var(--bg-card) 0%, var(--bg-card-light) 100%);
      border: 1px solid rgba(139, 92, 246, 0.3);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 16px;
      box-shadow: 
        0 4px 20px rgba(0, 0, 0, 0.4),
        0 0 40px rgba(139, 92, 246, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
    }

    .card-glow {
      position: relative;
    }

    .card-glow::before {
      content: '';
      position: absolute;
      top: -1px;
      left: -1px;
      right: -1px;
      bottom: -1px;
      border-radius: 17px;
      background: linear-gradient(135deg, var(--primary), var(--secondary), var(--accent));
      z-index: -1;
      opacity: 0.5;
      filter: blur(8px);
    }

    input[type="text"], input[type="number"] {
      width: 100%;
      padding: 16px 20px;
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid rgba(139, 92, 246, 0.3);
      border-radius: 12px;
      color: white;
      font-size: 18px;
      text-align: center;
      margin-bottom: 12px;
      transition: all 0.3s ease;
    }

    input:focus {
      outline: none;
      border-color: var(--primary);
      background: rgba(139, 92, 246, 0.1);
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.2);
    }

    input::placeholder {
      color: var(--text-secondary);
    }

    .btn {
      width: 100%;
      padding: 16px;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s;
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 25px rgba(139, 92, 246, 0.5);
    }

    .btn-red {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
    }

    .btn-green {
      background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(34, 197, 94, 0.3);
    }

    .btn-black {
      background: linear-gradient(135deg, #374151 0%, #1f2937 100%);
      color: white;
      border: 2px solid #4b5563;
    }

    .btn-gold {
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
      color: #1a1a2e;
      box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4);
    }

    .btn-outline {
      background: transparent;
      border: 2px solid rgba(139, 92, 246, 0.5);
      color: var(--primary);
    }

    .btn-outline:hover:not(:disabled) {
      background: rgba(139, 92, 246, 0.1);
      border-color: var(--primary);
    }

    .btn-selected {
      box-shadow: 0 0 0 3px var(--gold), 0 4px 15px rgba(251, 191, 36, 0.4) !important;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding: 16px 20px;
      background: linear-gradient(135deg, var(--bg-card) 0%, rgba(139, 92, 246, 0.1) 100%);
      border-radius: 16px;
      border: 1px solid rgba(139, 92, 246, 0.2);
    }

    .header-title {
      font-size: 22px;
      font-weight: 800;
      background: linear-gradient(135deg, var(--gold) 0%, #fef3c7 50%, var(--gold) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header-subtitle {
      color: var(--text-secondary);
      font-size: 14px;
    }

    .balance-box {
      background: linear-gradient(135deg, rgba(251, 191, 36, 0.2) 0%, rgba(217, 119, 6, 0.1) 100%);
      border: 1px solid rgba(251, 191, 36, 0.3);
      border-radius: 12px;
      padding: 12px 20px;
      text-align: right;
    }

    .balance-label {
      font-size: 11px;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .balance-value {
      font-size: 22px;
      font-weight: 800;
      color: var(--gold);
      text-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
    }

    .tabs {
      display: flex;
      background: var(--bg-card);
      border-radius: 12px;
      margin-bottom: 16px;
      padding: 4px;
      border: 1px solid rgba(139, 92, 246, 0.2);
    }

    .tab {
      flex: 1;
      padding: 14px 8px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
      background: transparent;
      color: var(--text-secondary);
      font-size: 13px;
      font-weight: 600;
      border-radius: 8px;
    }

    .tab.active {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
    }

    .tab:hover:not(.active) {
      color: var(--primary);
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Roulette Wheel */
    .wheel-container {
      position: relative;
      width: 260px;
      height: 260px;
      margin: 0 auto 24px;
    }

    .wheel-pointer {
      position: absolute;
      top: -5px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 14px solid transparent;
      border-right: 14px solid transparent;
      border-top: 24px solid var(--gold);
      z-index: 10;
      filter: drop-shadow(0 4px 8px rgba(251, 191, 36, 0.5));
    }

    .wheel {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      position: relative;
      overflow: hidden;
      box-shadow: 
        0 0 0 6px var(--gold),
        0 0 30px rgba(139, 92, 246, 0.4),
        inset 0 0 30px rgba(0, 0, 0, 0.3);
    }

    .wheel-slice {
      position: absolute;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: flex-start;
      justify-content: center;
    }

    .wheel-slice-inner {
      width: 22px;
      height: 130px;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding-top: 10px;
      color: white;
      font-size: 9px;
      font-weight: bold;
      clip-path: polygon(30% 0, 70% 0, 100% 100%, 0 100%);
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }

    .wheel-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, var(--bg-card) 0%, #2d2d4a 100%);
      border: 3px solid var(--gold);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
    }

    .result-display {
      text-align: center;
      margin-bottom: 20px;
      padding: 16px;
      background: rgba(139, 92, 246, 0.1);
      border-radius: 12px;
      border: 1px solid rgba(139, 92, 246, 0.2);
    }

    .result-label {
      color: var(--text-secondary);
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 4px;
    }

    .result-value {
      font-size: 32px;
      font-weight: 800;
    }

    .grid-3 {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-bottom: 16px;
    }

    .grid-5 {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
      margin-bottom: 12px;
    }

    /* Crash Game */
    .crash-display {
      height: 200px;
      background: linear-gradient(180deg, rgba(139, 92, 246, 0.1) 0%, transparent 100%);
      border: 1px solid rgba(139, 92, 246, 0.3);
      border-radius: 16px;
      position: relative;
      margin-bottom: 20px;
      overflow: hidden;
    }

    .crash-graph {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 100%;
    }

    .crash-graph-line {
      position: absolute;
      bottom: 20px;
      left: 20px;
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--success), var(--gold));
      transition: all 0.1s linear;
      box-shadow: 0 0 10px var(--success);
    }

    .crash-multiplier {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 64px;
      font-weight: 800;
      text-shadow: 0 0 40px rgba(139, 92, 246, 0.8);
      transition: all 0.1s;
    }

    .crash-multiplier.crashed {
      color: var(--danger);
      text-shadow: 0 0 40px rgba(239, 68, 68, 0.8);
      animation: shake 0.5s;
    }

    @keyframes shake {
      0%, 100% { transform: translate(-50%, -50%) rotate(0); }
      25% { transform: translate(-50%, -50%) rotate(-5deg); }
      75% { transform: translate(-50%, -50%) rotate(5deg); }
    }

    .crash-status {
      position: absolute;
      bottom: 16px;
      left: 50%;
      transform: translateX(-50%);
      padding: 8px 16px;
      background: rgba(0, 0, 0, 0.6);
      border-radius: 20px;
      font-size: 12px;
      color: var(--text-secondary);
    }

    /* Ladder Game */
    .ladder-visual {
      height: 280px;
      background: linear-gradient(180deg, 
        rgba(239, 68, 68, 0.2) 0%, 
        rgba(245, 158, 11, 0.2) 35%, 
        rgba(34, 197, 94, 0.2) 100%);
      border-radius: 16px;
      position: relative;
      margin-bottom: 20px;
      overflow: hidden;
      border: 1px solid rgba(139, 92, 246, 0.2);
    }

    .ladder-levels {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 16px;
    }

    .ladder-level {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 16px;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .ladder-level.active {
      background: rgba(139, 92, 246, 0.4);
      border: 1px solid var(--primary);
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
    }

    .ladder-level-chance {
      font-weight: 700;
      font-size: 16px;
    }

    .ladder-level-mult {
      color: var(--gold);
      font-weight: 800;
      font-size: 18px;
      text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
    }

    .ladder-overlay {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
    }

    .ladder-result {
      font-size: 80px;
    }

    .ladder-playing {
      width: 80px;
      height: 80px;
      border: 4px solid var(--primary);
      border-radius: 50%;
      border-top-color: transparent;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0) scale(1); }
      50% { transform: translateY(-20px) scale(1.1); }
    }

    .bounce {
      animation: bounce 0.5s ease-in-out infinite;
    }

    .range-slider {
      width: 100%;
      height: 10px;
      background: var(--bg-card-light);
      border-radius: 10px;
      appearance: none;
      cursor: pointer;
      margin: 12px 0;
    }

    .range-slider::-webkit-slider-thumb {
      appearance: none;
      width: 26px;
      height: 26px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(139, 92, 246, 0.5);
      transition: transform 0.2s;
    }

    .range-slider::-webkit-slider-thumb:hover {
      transform: scale(1.1);
    }

    .range-info {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      color: var(--text-secondary);
      margin-top: 4px;
    }

    .quick-bets {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
      margin-top: 20px;
    }

    .quick-bet-btn {
      padding: 10px 16px;
      font-size: 13px;
      min-width: 60px;
    }

    .premium-note {
      text-align: center;
      color: var(--gold);
      font-size: 13px;
      margin-top: 16px;
      padding: 12px;
      background: rgba(251, 191, 36, 0.1);
      border-radius: 8px;
      border: 1px solid rgba(251, 191, 36, 0.2);
    }

    .toast {
      position: fixed;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%);
      padding: 14px 28px;
      border-radius: 12px;
      font-weight: 600;
      z-index: 1000;
      animation: slideUp 0.3s ease-out;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
    }

    .toast-success {
      background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
      color: white;
    }

    .toast-error {
      background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%);
      color: white;
    }

    @keyframes slideUp {
      from { transform: translate(-50%, 100%); opacity: 0; }
      to { transform: translate(-50%, 0); opacity: 1; }
    }

    .hidden {
      display: none !important;
    }

    .label {
      color: var(--text-secondary);
      font-size: 13px;
      margin-bottom: 8px;
      display: block;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .loading-screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 80vh;
      text-align: center;
    }

    .loading-spinner {
      width: 80px;
      height: 80px;
      border: 4px solid rgba(139, 92, 246, 0.2);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 24px;
    }

    .loading-screen h2 {
      font-size: 24px;
      margin-bottom: 8px;
      background: linear-gradient(135deg, var(--gold) 0%, var(--primary) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .error-message {
      color: var(--danger);
      font-size: 14px;
      margin-top: 16px;
      padding: 16px;
      background: rgba(239, 68, 68, 0.1);
      border-radius: 8px;
      border: 1px solid rgba(239, 68, 68, 0.2);
    }

    /* Coins animation */
    .coin-rain {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      z-index: 1000;
      overflow: hidden;
    }

    .coin {
      position: absolute;
      font-size: 24px;
      animation: coinFall 2s ease-in forwards;
    }

    @keyframes coinFall {
      0% { transform: translateY(-50px) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }

    /* Crash chart line */
    .crash-chart {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      top: 0;
      overflow: hidden;
    }

    .crash-line {
      fill: none;
      stroke: url(#crashGradient);
      stroke-width: 3;
      stroke-linecap: round;
    }

    .crash-area {
      fill: url(#crashAreaGradient);
    }
  </style>
</head>
<body>
  <!-- Loading Screen -->
  <div id="loadingScreen" class="container">
    <div class="loading-screen">
      <div class="loading-spinner"></div>
      <h2>üé∞ Royal Casino</h2>
      <p style="color: var(--text-secondary);">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
      <p id="loadingError" class="error-message hidden"></p>
    </div>
  </div>

  <!-- Main Game Screen -->
  <div id="gameScreen" class="container hidden">
    <div class="header">
      <div>
        <div class="header-title">üëë Royal Casino</div>
        <div class="header-subtitle" id="playerName">–ò–≥—Ä–æ–∫</div>
      </div>
      <div class="balance-box">
        <div class="balance-label">–ë–∞–ª–∞–Ω—Å</div>
        <div class="balance-value">üí∞ <span id="balanceDisplay">0</span></div>
      </div>
    </div>

    <div class="tabs">
      <button class="tab active" data-tab="roulette">üé° –†—É–ª–µ—Ç–∫–∞</button>
      <button class="tab" data-tab="crash">üöÄ –ö—Ä–∞—à</button>
      <button class="tab" data-tab="ladder">üìà –õ–µ—Å–µ–Ω–∫–∞</button>
    </div>

    <!-- Roulette Tab -->
    <div id="rouletteTab" class="tab-content active">
      <div class="card card-glow">
        <div class="wheel-container">
          <div class="wheel-pointer"></div>
          <div class="wheel" id="rouletteWheel"></div>
          <div class="wheel-center">üé∞</div>
        </div>

        <div class="result-display" id="rouletteResult" style="display: none;">
          <div class="result-label">–†–µ–∑—É–ª—å—Ç–∞—Ç</div>
          <div class="result-value" id="resultValue"></div>
        </div>

        <input type="number" id="rouletteBetInput" placeholder="üí∞ –í–≤–µ–¥–∏—Ç–µ —Å—Ç–∞–≤–∫—É">

        <div class="grid-3">
          <button class="btn btn-red btn-selected" id="betRed">üî¥ x2</button>
          <button class="btn btn-green" id="betGreen">üü¢ x14</button>
          <button class="btn btn-black" id="betBlack">‚ö´ x2</button>
        </div>

        <button class="btn btn-primary" id="spinBtn">üé≤ –ö–†–£–¢–ò–¢–¨</button>
      </div>
    </div>

    <!-- Crash Tab -->
    <div id="crashTab" class="tab-content">
      <div class="card card-glow">
        <div class="crash-display">
          <svg class="crash-chart" id="crashChart" viewBox="0 0 400 200" preserveAspectRatio="none">
            <defs>
              <linearGradient id="crashGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#10b981"/>
                <stop offset="100%" style="stop-color:#fbbf24"/>
              </linearGradient>
              <linearGradient id="crashAreaGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#10b981;stop-opacity:0.3"/>
                <stop offset="100%" style="stop-color:#10b981;stop-opacity:0"/>
              </linearGradient>
            </defs>
            <path class="crash-area" id="crashArea" d="M0,200 L0,200 L0,200 Z"></path>
            <path class="crash-line" id="crashLine" d="M0,200"></path>
          </svg>
          <div class="crash-multiplier" id="crashMultiplier">1.00x</div>
          <div class="crash-status" id="crashStatus">–û–∂–∏–¥–∞–Ω–∏–µ —Ä–∞—É–Ω–¥–∞...</div>
        </div>

        <input type="number" id="crashBetInput" placeholder="üí∞ –í–≤–µ–¥–∏—Ç–µ —Å—Ç–∞–≤–∫—É">

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;">
          <div>
            <label class="label">–ê–≤—Ç–æ-–≤—ã–≤–æ–¥</label>
            <input type="number" id="autoCashoutInput" placeholder="2.00" step="0.1" min="1.1">
          </div>
          <div style="display: flex; align-items: flex-end;">
            <button class="btn btn-gold" id="crashCashoutBtn" disabled style="height: 52px;">üí∞ –ó–ê–ë–†–ê–¢–¨</button>
          </div>
        </div>

        <button class="btn btn-primary" id="crashBetBtn">üöÄ –°–¢–ê–í–ö–ê</button>
      </div>
    </div>

    <!-- Ladder Tab -->
    <div id="ladderTab" class="tab-content">
      <div class="card card-glow">
        <div class="ladder-visual">
          <div class="ladder-levels">
            <div class="ladder-level" data-chance="90">
              <span class="ladder-level-chance">90%</span>
              <span class="ladder-level-mult">x1.06</span>
            </div>
            <div class="ladder-level" data-chance="70">
              <span class="ladder-level-chance">70%</span>
              <span class="ladder-level-mult">x1.36</span>
            </div>
            <div class="ladder-level active" data-chance="50">
              <span class="ladder-level-chance">50%</span>
              <span class="ladder-level-mult">x1.90</span>
            </div>
            <div class="ladder-level" data-chance="30">
              <span class="ladder-level-chance">30%</span>
              <span class="ladder-level-mult">x3.17</span>
            </div>
            <div class="ladder-level" data-chance="10">
              <span class="ladder-level-chance">10%</span>
              <span class="ladder-level-mult">x9.50</span>
            </div>
          </div>
          <div id="ladderOverlay" class="ladder-overlay hidden"></div>
        </div>

        <label class="label">–°—Ç–∞–≤–∫–∞</label>
        <input type="number" id="ladderBetInput" placeholder="üí∞ –í–≤–µ–¥–∏—Ç–µ —Å—Ç–∞–≤–∫—É">

        <label class="label" id="ladderChanceLabel">–®–∞–Ω—Å: 50% | –ú–Ω–æ–∂–∏—Ç–µ–ª—å: x1.90</label>
        <input type="range" class="range-slider" id="ladderChanceSlider" min="5" max="95" value="50">
        <div class="range-info">
          <span>5% (x19.00)</span>
          <span>95% (x1.00)</span>
        </div>

        <div class="grid-5" style="margin-top: 16px;">
          <button class="btn btn-outline quick-chance" data-chance="10">10%</button>
          <button class="btn btn-outline quick-chance" data-chance="25">25%</button>
          <button class="btn btn-outline btn-selected quick-chance" data-chance="50">50%</button>
          <button class="btn btn-outline quick-chance" data-chance="75">75%</button>
          <button class="btn btn-outline quick-chance" data-chance="90">90%</button>
        </div>

        <button class="btn btn-primary" id="ladderPlayBtn" style="margin-top: 16px;">üé≤ –ò–ì–†–ê–¢–¨ (x1.90)</button>
      </div>
    </div>

    <!-- Quick Bets -->
    <div class="quick-bets">
      <button class="btn btn-outline quick-bet-btn" data-amount="1000">1K</button>
      <button class="btn btn-outline quick-bet-btn" data-amount="5000">5K</button>
      <button class="btn btn-outline quick-bet-btn" data-amount="10000">10K</button>
      <button class="btn btn-outline quick-bet-btn" data-amount="50000">50K</button>
      <button class="btn btn-outline quick-bet-btn" data-amount="100000">100K</button>
      <button class="btn btn-gold quick-bet-btn" id="allInBtn">‚ö° ALL IN</button>
    </div>

    <div class="premium-note hidden" id="premiumNote">üëë Premium –∞–∫—Ç–∏–≤–µ–Ω - x2 –∫–æ –≤—Å–µ–º –≤—ã–∏–≥—Ä—ã—à–∞–º!</div>
  </div>

  <script>
    // Supabase Configuration
    const SUPABASE_URL = 'https://qvfhieihrshgcljngpcq.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF2ZmhpZWlocnNoZ2Nsam5ncGNxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMwNDAyMjMsImV4cCI6MjA3ODYxNjIyM30.vR1PHx7ZxHibt06jWzowzSZjbXliz15cCknnTZpLxpo';

    // Telegram WebApp
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    // Roulette Numbers
    const ROULETTE_NUMBERS = [
      { num: 0, color: 'green' },
      { num: 32, color: 'red' }, { num: 15, color: 'black' }, { num: 19, color: 'red' }, { num: 4, color: 'black' },
      { num: 21, color: 'red' }, { num: 2, color: 'black' }, { num: 25, color: 'red' }, { num: 17, color: 'black' },
      { num: 34, color: 'red' }, { num: 6, color: 'black' }, { num: 27, color: 'red' }, { num: 13, color: 'black' },
      { num: 36, color: 'red' }, { num: 11, color: 'black' }, { num: 30, color: 'red' }, { num: 8, color: 'black' },
      { num: 23, color: 'red' }, { num: 10, color: 'black' }, { num: 5, color: 'red' }, { num: 24, color: 'black' },
      { num: 16, color: 'red' }, { num: 33, color: 'black' }, { num: 1, color: 'red' }, { num: 20, color: 'black' },
      { num: 14, color: 'red' }, { num: 31, color: 'black' }, { num: 9, color: 'red' }, { num: 22, color: 'black' },
      { num: 18, color: 'red' }, { num: 29, color: 'black' }, { num: 7, color: 'red' }, { num: 28, color: 'black' },
      { num: 12, color: 'red' }, { num: 35, color: 'black' }, { num: 3, color: 'red' }, { num: 26, color: 'black' },
    ];

    // State
    let player = null;
    let currentBetType = 'red';
    let currentRotation = 0;
    let isSpinning = false;
    let ladderChance = 50;
    let ladderMultiplier = 1.9;
    let ladderPlaying = false;
    let activeTab = 'roulette';

    // Crash state
    let crashState = 'waiting'; // waiting, running, crashed
    let crashMultiplier = 1.00;
    let crashBet = 0;
    let crashInterval = null;
    let crashStartTime = 0;
    let crashPoints = [];
    let playerCashedOut = false;

    // DOM Elements
    const loadingScreen = document.getElementById('loadingScreen');
    const loadingError = document.getElementById('loadingError');
    const gameScreen = document.getElementById('gameScreen');
    const playerNameEl = document.getElementById('playerName');
    const balanceDisplay = document.getElementById('balanceDisplay');
    const rouletteWheel = document.getElementById('rouletteWheel');
    const rouletteBetInput = document.getElementById('rouletteBetInput');
    const spinBtn = document.getElementById('spinBtn');
    const rouletteResult = document.getElementById('rouletteResult');
    const resultValue = document.getElementById('resultValue');
    const ladderBetInput = document.getElementById('ladderBetInput');
    const ladderChanceSlider = document.getElementById('ladderChanceSlider');
    const ladderChanceLabel = document.getElementById('ladderChanceLabel');
    const ladderPlayBtn = document.getElementById('ladderPlayBtn');
    const ladderOverlay = document.getElementById('ladderOverlay');
    const premiumNote = document.getElementById('premiumNote');

    // Crash elements
    const crashBetInput = document.getElementById('crashBetInput');
    const autoCashoutInput = document.getElementById('autoCashoutInput');
    const crashBetBtn = document.getElementById('crashBetBtn');
    const crashCashoutBtn = document.getElementById('crashCashoutBtn');
    const crashMultiplierEl = document.getElementById('crashMultiplier');
    const crashStatusEl = document.getElementById('crashStatus');
    const crashLine = document.getElementById('crashLine');
    const crashArea = document.getElementById('crashArea');

    // Toast notification
    function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      toast.className = `toast toast-${type}`;
      toast.textContent = message;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    // Coin rain effect
    function showCoinRain() {
      const container = document.createElement('div');
      container.className = 'coin-rain';
      document.body.appendChild(container);

      for (let i = 0; i < 30; i++) {
        setTimeout(() => {
          const coin = document.createElement('span');
          coin.className = 'coin';
          coin.textContent = 'üí∞';
          coin.style.left = Math.random() * 100 + '%';
          coin.style.animationDelay = Math.random() * 0.5 + 's';
          container.appendChild(coin);
        }, i * 50);
      }

      setTimeout(() => container.remove(), 3000);
    }

    // Supabase API helper
    async function supabaseRequest(table, method = 'GET', body = null, query = '') {
      const url = `${SUPABASE_URL}/rest/v1/${table}${query}`;
      const options = {
        method,
        headers: {
          'apikey': SUPABASE_ANON_KEY,
          'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
          'Content-Type': 'application/json',
          'Prefer': method === 'PATCH' ? 'return=representation' : 'return=minimal'
        }
      };
      if (body) options.body = JSON.stringify(body);
      
      const response = await fetch(url, options);
      if (!response.ok) throw new Error('API Error');
      if (method === 'GET' || method === 'PATCH') {
        return response.json();
      }
      return null;
    }

    // Initialize roulette wheel
    function initWheel() {
      rouletteWheel.innerHTML = '';
      ROULETTE_NUMBERS.forEach((slot, index) => {
        const angle = (360 / ROULETTE_NUMBERS.length) * index;
        const bgColor = slot.color === 'red' ? '#ef4444' : slot.color === 'black' ? '#1f2937' : '#22c55e';
        
        const slice = document.createElement('div');
        slice.className = 'wheel-slice';
        slice.style.transform = `rotate(${angle}deg)`;
        
        const inner = document.createElement('div');
        inner.className = 'wheel-slice-inner';
        inner.style.background = bgColor;
        inner.textContent = slot.num;
        
        slice.appendChild(inner);
        rouletteWheel.appendChild(slice);
      });
    }

    // Auto-login via Telegram WebApp
    async function autoLogin() {
      const user = tg.initDataUnsafe?.user;
      
      if (!user || !user.id) {
        loadingError.textContent = '–û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞–∑–∏–Ω–æ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞ @squid_game_russia_bot';
        loadingError.classList.remove('hidden');
        return;
      }

      console.log('Telegram user:', user);

      try {
        const data = await supabaseRequest('squid_players', 'GET', null, `?telegram_id=eq.${user.id}&select=id,telegram_id,balance,username,first_name,is_premium`);
        
        if (!data || data.length === 0) {
          loadingError.textContent = '–ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω. –°–Ω–∞—á–∞–ª–∞ –Ω–∞–ø–∏—à–∏—Ç–µ /start –±–æ—Ç—É @squid_game_russia_bot';
          loadingError.classList.remove('hidden');
          return;
        }

        player = data[0];
        loadingScreen.classList.add('hidden');
        gameScreen.classList.remove('hidden');
        updateUI();
        showToast(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${player.first_name || player.username || '–ò–≥—Ä–æ–∫'}! üëë`);
        
        // Start crash game simulation
        startCrashSimulation();
      } catch (error) {
        console.error(error);
        loadingError.textContent = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.';
        loadingError.classList.remove('hidden');
      }
    }

    // Update UI
    function updateUI() {
      playerNameEl.textContent = (player.first_name || player.username || '–ò–≥—Ä–æ–∫') + (player.is_premium ? ' üëë' : '');
      balanceDisplay.textContent = player.balance.toLocaleString();
      if (player.is_premium) {
        premiumNote.classList.remove('hidden');
      }
    }

    // Refresh balance
    async function refreshBalance() {
      try {
        const data = await supabaseRequest('squid_players', 'GET', null, `?id=eq.${player.id}&select=balance`);
        if (data && data.length > 0) {
          player.balance = data[0].balance;
          updateUI();
        }
      } catch (e) {
        console.error(e);
      }
    }

    // Tab switching
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        activeTab = tab.dataset.tab;
        document.getElementById(`${activeTab}Tab`).classList.add('active');
      });
    });

    // Roulette bet type selection
    ['betRed', 'betGreen', 'betBlack'].forEach(id => {
      document.getElementById(id).addEventListener('click', (e) => {
        document.querySelectorAll('.grid-3 .btn').forEach(b => b.classList.remove('btn-selected'));
        e.target.classList.add('btn-selected');
        currentBetType = id.replace('bet', '').toLowerCase();
      });
    });

    // Spin roulette
    spinBtn.addEventListener('click', async () => {
      if (isSpinning) return;
      
      const bet = parseInt(rouletteBetInput.value);
      if (isNaN(bet) || bet <= 0) {
        showToast('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Ç–∞–≤–∫—É', 'error');
        return;
      }
      if (bet > player.balance) {
        showToast('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç', 'error');
        return;
      }

      isSpinning = true;
      spinBtn.disabled = true;
      spinBtn.textContent = 'üé∞ –ö–†–£–¢–ò–¢–°–Ø...';

      // Deduct bet
      try {
        await supabaseRequest('squid_players', 'PATCH', { balance: player.balance - bet }, `?id=eq.${player.id}`);
        player.balance -= bet;
        updateUI();
      } catch (e) {
        showToast('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞', 'error');
        isSpinning = false;
        spinBtn.disabled = false;
        spinBtn.textContent = 'üé≤ –ö–†–£–¢–ò–¢–¨';
        return;
      }

      // Determine result
      const rand = Math.random() * 100;
      let resultColor;
      if (rand < 3) {
        resultColor = 'green';
      } else if (rand < 51.5) {
        resultColor = 'red';
      } else {
        resultColor = 'black';
      }

      const possibleNumbers = ROULETTE_NUMBERS.filter(n => n.color === resultColor);
      const resultNumber = possibleNumbers[Math.floor(Math.random() * possibleNumbers.length)];
      const resultIndex = ROULETTE_NUMBERS.findIndex(n => n.num === resultNumber.num);

      // Calculate rotation
      const sliceAngle = 360 / ROULETTE_NUMBERS.length;
      const targetAngle = resultIndex * sliceAngle;
      const spins = 5 + Math.floor(Math.random() * 3);
      currentRotation += (360 * spins) + (360 - targetAngle) + sliceAngle / 2;

      rouletteWheel.style.transition = 'transform 5s cubic-bezier(0.17, 0.67, 0.12, 0.99)';
      rouletteWheel.style.transform = `rotate(${currentRotation}deg)`;

      // Wait for animation
      setTimeout(async () => {
        rouletteResult.style.display = 'block';
        const colorEmoji = resultNumber.color === 'red' ? 'üî¥' : resultNumber.color === 'black' ? '‚ö´' : 'üü¢';
        const colorClass = resultNumber.color === 'red' ? 'color: #ef4444;' : resultNumber.color === 'black' ? 'color: #d1d5db;' : 'color: #22c55e;';
        resultValue.innerHTML = `<span style="${colorClass}">${resultNumber.num} ${colorEmoji}</span>`;

        const won = currentBetType === resultNumber.color;
        let winAmount = 0;

        if (won) {
          winAmount = resultNumber.color === 'green' ? bet * 14 : bet * 2;
          if (player.is_premium) winAmount = Math.floor(winAmount * 2);

          try {
            await supabaseRequest('squid_players', 'PATCH', { balance: player.balance + winAmount }, `?id=eq.${player.id}`);
            showToast(`üéâ –í—ã–∏–≥—Ä—ã—à! +${winAmount.toLocaleString()} –º–æ–Ω–µ—Ç`);
            showCoinRain();
          } catch (e) {
            console.error(e);
          }
        } else {
          showToast(`üíÄ –ü—Ä–æ–∏–≥—Ä—ã—à! –í—ã–ø–∞–ª–æ: ${resultNumber.num} ${colorEmoji}`, 'error');
        }

        await refreshBalance();
        isSpinning = false;
        spinBtn.disabled = false;
        spinBtn.textContent = 'üé≤ –ö–†–£–¢–ò–¢–¨';
      }, 5000);
    });

    // Crash game simulation
    function startCrashSimulation() {
      simulateCrashRound();
    }

    function simulateCrashRound() {
      crashState = 'waiting';
      crashMultiplier = 1.00;
      crashPoints = [];
      crashBet = 0;
      playerCashedOut = false;
      crashBetBtn.disabled = false;
      crashBetBtn.textContent = 'üöÄ –°–¢–ê–í–ö–ê';
      crashCashoutBtn.disabled = true;
      crashMultiplierEl.textContent = '1.00x';
      crashMultiplierEl.classList.remove('crashed');
      crashMultiplierEl.style.color = '';
      crashStatusEl.textContent = '–ù–æ–≤—ã–π —Ä–∞—É–Ω–¥ —á–µ—Ä–µ–∑ 3 —Å–µ–∫...';
      
      // Reset chart
      crashLine.setAttribute('d', 'M0,200');
      crashArea.setAttribute('d', 'M0,200 L0,200 L0,200 Z');

      let countdown = 3;
      const countdownInterval = setInterval(() => {
        countdown--;
        if (countdown > 0) {
          crashStatusEl.textContent = `–ù–æ–≤—ã–π —Ä–∞—É–Ω–¥ —á–µ—Ä–µ–∑ ${countdown} —Å–µ–∫...`;
        } else {
          clearInterval(countdownInterval);
          runCrashRound();
        }
      }, 1000);
    }

    function runCrashRound() {
      crashState = 'running';
      crashStartTime = Date.now();
      crashStatusEl.textContent = '–ò–≥—Ä–∞ –∏–¥—ë—Ç!';
      
      if (crashBet > 0) {
        crashCashoutBtn.disabled = false;
      }

      // Calculate crash point (house edge ~4%)
      const rand = Math.random();
      const crashPoint = Math.max(1.0, 0.99 / (1 - rand));
      
      crashInterval = setInterval(() => {
        const elapsed = (Date.now() - crashStartTime) / 1000;
        crashMultiplier = Math.pow(Math.E, 0.15 * elapsed);
        
        // Update display
        crashMultiplierEl.textContent = crashMultiplier.toFixed(2) + 'x';
        crashMultiplierEl.style.color = getMultiplierColor(crashMultiplier);
        
        // Update chart
        updateCrashChart(elapsed);
        
        // Check auto cashout
        const autoCashout = parseFloat(autoCashoutInput.value);
        if (!playerCashedOut && crashBet > 0 && autoCashout && crashMultiplier >= autoCashout) {
          doCashout();
        }
        
        // Check crash
        if (crashMultiplier >= crashPoint) {
          clearInterval(crashInterval);
          crashGame();
        }
      }, 50);
    }

    function getMultiplierColor(mult) {
      if (mult < 1.5) return '#22c55e';
      if (mult < 2) return '#84cc16';
      if (mult < 3) return '#eab308';
      if (mult < 5) return '#f97316';
      return '#ef4444';
    }

    function updateCrashChart(elapsed) {
      const maxTime = 10;
      const x = Math.min((elapsed / maxTime) * 400, 400);
      const y = Math.max(200 - (Math.log(crashMultiplier) * 60), 10);
      
      crashPoints.push({ x, y });
      
      // Build path
      let pathD = 'M0,200';
      crashPoints.forEach((point, i) => {
        pathD += ` L${point.x},${point.y}`;
      });
      crashLine.setAttribute('d', pathD);
      
      // Build area
      let areaD = 'M0,200 ' + pathD.substring(5) + ` L${x},200 Z`;
      crashArea.setAttribute('d', areaD);
    }

    function crashGame() {
      crashState = 'crashed';
      crashMultiplierEl.textContent = crashMultiplier.toFixed(2) + 'x';
      crashMultiplierEl.classList.add('crashed');
      crashStatusEl.textContent = 'üí• –ö–†–ê–®!';
      crashCashoutBtn.disabled = true;
      crashBetBtn.disabled = true;
      
      if (crashBet > 0 && !playerCashedOut) {
        showToast(`üí• –ö—Ä–∞—à –Ω–∞ ${crashMultiplier.toFixed(2)}x! –ü—Ä–æ–∏–≥—Ä—ã—à ${crashBet.toLocaleString()} –º–æ–Ω–µ—Ç`, 'error');
        crashBet = 0;
      }
      
      // Start next round after delay
      setTimeout(simulateCrashRound, 3000);
    }

    async function doCashout() {
      if (playerCashedOut || crashBet <= 0) return;
      
      playerCashedOut = true;
      crashCashoutBtn.disabled = true;
      
      let winAmount = Math.floor(crashBet * crashMultiplier);
      if (player.is_premium) winAmount = Math.floor(winAmount * 2);
      
      try {
        await supabaseRequest('squid_players', 'PATCH', { balance: player.balance + winAmount }, `?id=eq.${player.id}`);
        showToast(`üéâ –í—ã–≤–æ–¥ –Ω–∞ ${crashMultiplier.toFixed(2)}x! +${winAmount.toLocaleString()} –º–æ–Ω–µ—Ç`);
        showCoinRain();
        await refreshBalance();
      } catch (e) {
        console.error(e);
      }
      
      crashBet = 0;
    }

    // Crash bet button
    crashBetBtn.addEventListener('click', async () => {
      if (crashState !== 'waiting' && crashState !== 'running') return;
      
      const bet = parseInt(crashBetInput.value);
      if (isNaN(bet) || bet <= 0) {
        showToast('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Ç–∞–≤–∫—É', 'error');
        return;
      }
      if (bet > player.balance) {
        showToast('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç', 'error');
        return;
      }
      
      try {
        await supabaseRequest('squid_players', 'PATCH', { balance: player.balance - bet }, `?id=eq.${player.id}`);
        player.balance -= bet;
        updateUI();
        crashBet = bet;
        crashBetBtn.disabled = true;
        crashBetBtn.textContent = `‚úÖ –°—Ç–∞–≤–∫–∞: ${bet.toLocaleString()}`;
        
        if (crashState === 'running') {
          crashCashoutBtn.disabled = false;
        }
        
        showToast(`–°—Ç–∞–≤–∫–∞ ${bet.toLocaleString()} –ø—Ä–∏–Ω—è—Ç–∞!`);
      } catch (e) {
        showToast('–û—à–∏–±–∫–∞', 'error');
      }
    });

    // Crash cashout button
    crashCashoutBtn.addEventListener('click', doCashout);

    // Ladder chance slider
    ladderChanceSlider.addEventListener('input', (e) => {
      ladderChance = parseInt(e.target.value);
      ladderMultiplier = (95 / ladderChance).toFixed(2);
      ladderChanceLabel.textContent = `–®–∞–Ω—Å: ${ladderChance}% | –ú–Ω–æ–∂–∏—Ç–µ–ª—å: x${ladderMultiplier}`;
      ladderPlayBtn.textContent = `üé≤ –ò–ì–†–ê–¢–¨ (x${ladderMultiplier})`;
      
      document.querySelectorAll('.ladder-level').forEach(level => {
        level.classList.remove('active');
      });
      document.querySelectorAll('.quick-chance').forEach(btn => {
        btn.classList.remove('btn-selected');
        if (parseInt(btn.dataset.chance) === ladderChance) {
          btn.classList.add('btn-selected');
        }
      });
    });

    // Quick chance buttons
    document.querySelectorAll('.quick-chance').forEach(btn => {
      btn.addEventListener('click', () => {
        ladderChanceSlider.value = btn.dataset.chance;
        ladderChanceSlider.dispatchEvent(new Event('input'));
      });
    });

    // Play ladder
    ladderPlayBtn.addEventListener('click', async () => {
      if (ladderPlaying) return;

      const bet = parseInt(ladderBetInput.value);
      if (isNaN(bet) || bet <= 0) {
        showToast('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Ç–∞–≤–∫—É', 'error');
        return;
      }
      if (bet > player.balance) {
        showToast('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç', 'error');
        return;
      }

      ladderPlaying = true;
      ladderPlayBtn.disabled = true;
      ladderPlayBtn.textContent = '‚è≥ –ò–ì–†–ê...';

      // Deduct bet
      try {
        await supabaseRequest('squid_players', 'PATCH', { balance: player.balance - bet }, `?id=eq.${player.id}`);
        player.balance -= bet;
        updateUI();
      } catch (e) {
        showToast('–û—à–∏–±–∫–∞', 'error');
        ladderPlaying = false;
        ladderPlayBtn.disabled = false;
        ladderPlayBtn.textContent = `üé≤ –ò–ì–†–ê–¢–¨ (x${ladderMultiplier})`;
        return;
      }

      // Show playing animation
      ladderOverlay.classList.remove('hidden');
      ladderOverlay.innerHTML = '<div class="ladder-playing"></div>';

      // Determine result
      const rand = Math.random() * 100;
      const won = rand < ladderChance;

      setTimeout(async () => {
        if (won) {
          let winAmount = Math.floor(bet * parseFloat(ladderMultiplier));
          if (player.is_premium) winAmount = Math.floor(winAmount * 2);

          ladderOverlay.innerHTML = '<span class="ladder-result bounce">üéâ</span>';

          try {
            await supabaseRequest('squid_players', 'PATCH', { balance: player.balance + winAmount }, `?id=eq.${player.id}`);
            showToast(`üéâ –í—ã–∏–≥—Ä—ã—à! +${winAmount.toLocaleString()} –º–æ–Ω–µ—Ç (x${ladderMultiplier})`);
            showCoinRain();
          } catch (e) {
            console.error(e);
          }
        } else {
          ladderOverlay.innerHTML = '<span class="ladder-result">üíÄ</span>';
          showToast(`üíÄ –ü—Ä–æ–∏–≥—Ä—ã—à! –®–∞–Ω—Å –±—ã–ª ${ladderChance}%`, 'error');
        }

        await refreshBalance();

        setTimeout(() => {
          ladderOverlay.classList.add('hidden');
          ladderPlaying = false;
          ladderPlayBtn.disabled = false;
          ladderPlayBtn.textContent = `üé≤ –ò–ì–†–ê–¢–¨ (x${ladderMultiplier})`;
        }, 1500);
      }, 1500);
    });

    // Quick bet buttons
    document.querySelectorAll('.quick-bet-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const amount = btn.dataset.amount;
        if (activeTab === 'roulette') {
          rouletteBetInput.value = amount || player.balance;
        } else if (activeTab === 'crash') {
          crashBetInput.value = amount || player.balance;
        } else {
          ladderBetInput.value = amount || player.balance;
        }
      });
    });

    document.getElementById('allInBtn').addEventListener('click', () => {
      if (activeTab === 'roulette') {
        rouletteBetInput.value = player.balance;
      } else if (activeTab === 'crash') {
        crashBetInput.value = player.balance;
      } else {
        ladderBetInput.value = player.balance;
      }
    });

    // Initialize
    initWheel();
    autoLogin();
  </script>
</body>
</html>
